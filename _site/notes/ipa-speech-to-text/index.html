<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta http-equiv="Cache-control" content="public">
  <meta name="theme-color" content="#ffbd16">
  <meta name="color-scheme" content="light dark">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="/style.css">
  <!-- Grab title from the page data and dump it here -->
  <title>IPA Speech-to-Text Modelâ€¦? | Jackson Mostoller</title>
</head>
<body>
  <nav id="navbar">
  <a class="logotype">Jackson Mostoller</a>
  <ul>
    <li><a href="/">Home</a></li>
    <li><a href="/blog/">Blog</a></li>
    <li><a href="/notes/">Open Notes</a></li>
  </ul>
</nav>
  <!-- Grab the content from the page data and dump it here, and mark it as safe -->
  <!-- Safe docs: https://mozilla.github.io/nunjucks/templating.html#safe -->
  <main>
  <h1>IPA Speech-to-Text Modelâ€¦?</h1><p>Here's a thought: we've got <a href="https://huggingface.co">speech-to-text</a> models galore. We can take audio input from dozens (now hundreds?) of languages and feed it into a model, and out comes some text that matches. <a href="https://twitter.com/twominutepapers">What a time to be alive!</a> But hey, those strings of text that the models spit outâ€”what if those were <em>IPA</em> letters, instead of specifically Kazakh or French or Navajo or another particular alphabet's representation? That might be neat! Let's see what we can do...</p>
<h2>Getting data</h2>
<p>We should really probably use a pre-trained model, but in theory it seems like if a model is already trained on human language in general, it should be okay with a taking variety of languages' acoustic inputs. The trickier part is getting an annotated dataset that has audio labelled in IPA characters. One potential source: the [Wiktionary](https://wiktionary.org/], which conveniently has recordings <em>and</em> IPA representations (though not necessarily <em>precise transcriptions</em>) from words in hundreds of languages.</p>
<p><a href="https://www.internationalphoneticassociation.org/IPAcharts/IPA_chart_orig/pdfs/IPA_Kiel_2020_symbollist.pdf">Here's a chart of all of the IPA characters</a>, which will probably be helpful.</p>
<p><a href="https://blog.devgenius.io/the-most-underrated-feature-of-the-julia-programming-language-the-package-manager-652065f45a3a">Here's some Julia package handling info.</a></p>
<pre class="language-julia"><code class="language-julia"><span class="token keyword">using</span> JSON3<br><br><span class="token keyword">function</span> get_words<span class="token punctuation">(</span>file<span class="token punctuation">::</span>String<span class="token punctuation">)</span><br>    a<span class="token punctuation">::</span>Array<span class="token punctuation">{</span>AbstractDict<span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><br>    <span class="token keyword">for</span> line <span class="token keyword">in</span> eachline<span class="token punctuation">(</span>file<span class="token punctuation">)</span><br>        <span class="token keyword">if</span> occursin<span class="token punctuation">(</span><span class="token regex">r"\"ipa\""</span><span class="token punctuation">,</span>line<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> occursin<span class="token punctuation">(</span><span class="token regex">r"\"(mp3|ogg)_url\""</span><span class="token punctuation">,</span>line<span class="token punctuation">)</span><br>            push<span class="token operator">!</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span>JSON3<span class="token punctuation">.</span>read<span class="token punctuation">(</span>line<span class="token punctuation">)</span><span class="token punctuation">.</span>sounds<span class="token punctuation">)</span><br>        <span class="token keyword">end</span><br>    <span class="token keyword">end</span><br>    <span class="token keyword">return</span> a<br><span class="token keyword">end</span></code></pre>
<pre><code>{&quot;pos&quot;: &quot;name&quot;, &quot;head_templates&quot;: [{&quot;name&quot;: &quot;head&quot;, &quot;args&quot;: {&quot;1&quot;: &quot;es&quot;, &quot;2&quot;: &quot;proper nouns&quot;, &quot;head&quot;: &quot;&quot;, &quot;g&quot;: &quot;?&quot;, &quot;g2&quot;: &quot;&quot;, &quot;g3&quot;: &quot;&quot;}, &quot;expansion&quot;: &quot;Llanquihue ?&quot;}, {&quot;name&quot;: &quot;es-proper noun&quot;, &quot;args&quot;: {}, &quot;expansion&quot;: &quot;Llanquihue ?&quot;}], &quot;word&quot;: &quot;Llanquihue&quot;, &quot;lang&quot;: &quot;Spanish&quot;, &quot;lang_code&quot;: &quot;es&quot;, &quot;sounds&quot;: [{&quot;ipa&quot;: &quot;/\u029dan\u02c8kiwe/&quot;}, {&quot;ipa&quot;: &quot;[\u025f\u0361\u029d\u00e3\u014b\u02c8ki.we]&quot;}, {&quot;ipa&quot;: &quot;/\u029dan\u02c8kiwe/&quot;}, {&quot;ipa&quot;: &quot;[\u025f\u0361\u029d\u00e3\u014b\u02c8ki.we]&quot;}, {&quot;ipa&quot;: &quot;/\u028ean\u02c8kiwe/&quot;}, {&quot;ipa&quot;: &quot;[\u028e\u00e3\u014b\u02c8ki.we]&quot;}, {&quot;ipa&quot;: &quot;/\u0283an\u02c8kiwe/&quot;}, {&quot;ipa&quot;: &quot;[\u0283\u00e3\u014b\u02c8ki.we]&quot;}, {&quot;ipa&quot;: &quot;/\u0292an\u02c8kiwe/&quot;}, {&quot;ipa&quot;: &quot;[\u0292\u00e3\u014b\u02c8ki.we]&quot;}, {&quot;audio&quot;: &quot;LL-Q1321 (spa)-Millars-Llanquihue.wav&quot;, &quot;text&quot;: &quot;Audio (Spain)&quot;, &quot;tags&quot;: [&quot;Spain&quot;], &quot;ogg_url&quot;: &quot;https://upload.wikimedia.org/wikipedia/commons/transcoded/5/51/LL-Q1321_%28spa%29-Millars-Llanquihue.wav/LL-Q1321_%28spa%29-Millars-Llanquihue.wav.ogg&quot;, &quot;mp3_url&quot;: &quot;https://upload.wikimedia.org/wikipedia/commons/transcoded/5/51/LL-Q1321_%28spa%29-Millars-Llanquihue.wav/LL-Q1321_%28spa%29-Millars-Llanquihue.wav.mp3&quot;}], &quot;senses&quot;: [{&quot;raw_glosses&quot;: [&quot;A province of Chile&quot;], &quot;glosses&quot;: [&quot;A province of Chile&quot;], &quot;id&quot;: &quot;Llanquihue-es-name-ICxVvTSj&quot;, &quot;categories&quot;: [{&quot;name&quot;: &quot;Places in Chile&quot;, &quot;kind&quot;: &quot;place&quot;, &quot;parents&quot;: [&quot;Places&quot;, &quot;List of sets&quot;, &quot;Names&quot;, &quot;All sets&quot;, &quot;Proper nouns&quot;, &quot;Terms by semantic function&quot;, &quot;All topics&quot;, &quot;Fundamental&quot;, &quot;Lemmas&quot;], &quot;source&quot;: &quot;w&quot;, &quot;orig&quot;: &quot;es:Places in Chile&quot;, &quot;langcode&quot;: &quot;es&quot;}, {&quot;name&quot;: &quot;Provinces of Chile&quot;, &quot;kind&quot;: &quot;place&quot;, &quot;parents&quot;: [&quot;Provinces&quot;, &quot;Places&quot;, &quot;List of sets&quot;, &quot;Political subdivisions&quot;, &quot;Names&quot;, &quot;All sets&quot;, &quot;Polities&quot;, &quot;Proper nouns&quot;, &quot;Terms by semantic function&quot;, &quot;All topics&quot;, &quot;Fundamental&quot;, &quot;Lemmas&quot;], &quot;source&quot;: &quot;w&quot;, &quot;orig&quot;: &quot;es:Provinces of Chile&quot;, &quot;langcode&quot;: &quot;es&quot;}]}]}

{&quot;pos&quot;: &quot;name&quot;, &quot;head_templates&quot;: [{&quot;name&quot;: &quot;head&quot;, &quot;args&quot;: {&quot;1&quot;: &quot;es&quot;, &quot;2&quot;: &quot;proper nouns&quot;, &quot;head&quot;: &quot;&quot;, &quot;g&quot;: &quot;?&quot;, &quot;g2&quot;: &quot;&quot;, &quot;g3&quot;: &quot;&quot;}, &quot;expansion&quot;: &quot;Risaralda ?&quot;}, {&quot;name&quot;: &quot;es-proper noun&quot;, &quot;args&quot;: {}, &quot;expansion&quot;: &quot;Risaralda ?&quot;}], &quot;word&quot;: &quot;Risaralda&quot;, &quot;lang&quot;: &quot;Spanish&quot;, &quot;lang_code&quot;: &quot;es&quot;, &quot;sounds&quot;: [{&quot;ipa&quot;: &quot;/risa\u02c8\u027ealda/&quot;}, {&quot;ipa&quot;: &quot;[ri.sa\u02c8\u027eal\u032a.d\u032aa]&quot;}, {&quot;audio&quot;: &quot;LL-Q1321 (spa)-Millars-Risaralda.wav&quot;, &quot;text&quot;: &quot;Audio&quot;, &quot;ogg_url&quot;: &quot;https://upload.wikimedia.org/wikipedia/commons/transcoded/6/62/LL-Q1321_%28spa%29-Millars-Risaralda.wav/LL-Q1321_%28spa%29-Millars-Risaralda.wav.ogg&quot;, &quot;mp3_url&quot;: &quot;https://upload.wikimedia.org/wikipedia/commons/transcoded/6/62/LL-Q1321_%28spa%29-Millars-Risaralda.wav/LL-Q1321_%28spa%29-Millars-Risaralda.wav.mp3&quot;}], &quot;senses&quot;: [{&quot;raw_glosses&quot;: [&quot;A department of Colombia&quot;], &quot;glosses&quot;: [&quot;A department of Colombia&quot;], &quot;id&quot;: &quot;Risaralda-es-name-0Pwvq-oJ&quot;, &quot;categories&quot;: [{&quot;name&quot;: &quot;Departments of Colombia&quot;, &quot;kind&quot;: &quot;place&quot;, &quot;parents&quot;: [&quot;Departments&quot;, &quot;Places&quot;, &quot;List of sets&quot;, &quot;Political subdivisions&quot;, &quot;Names&quot;, &quot;All sets&quot;, &quot;Polities&quot;, &quot;Proper nouns&quot;, &quot;Terms by semantic function&quot;, &quot;All topics&quot;, &quot;Fundamental&quot;, &quot;Lemmas&quot;], &quot;source&quot;: &quot;w&quot;, &quot;orig&quot;: &quot;es:Departments of Colombia&quot;, &quot;langcode&quot;: &quot;es&quot;}, {&quot;name&quot;: &quot;Places in Colombia&quot;, &quot;kind&quot;: &quot;place&quot;, &quot;parents&quot;: [&quot;Places&quot;, &quot;List of sets&quot;, &quot;Names&quot;, &quot;All sets&quot;, &quot;Proper nouns&quot;, &quot;Terms by semantic function&quot;, &quot;All topics&quot;, &quot;Fundamental&quot;, &quot;Lemmas&quot;], &quot;source&quot;: &quot;w&quot;, &quot;orig&quot;: &quot;es:Places in Colombia&quot;, &quot;langcode&quot;: &quot;es&quot;}]}]}

{&quot;pos&quot;: &quot;noun&quot;, &quot;head_templates&quot;: [{&quot;name&quot;: &quot;es-noun&quot;, &quot;args&quot;: {&quot;1&quot;: &quot;mf&quot;, &quot;f&quot;: &quot;jueza&quot;}, &quot;expansion&quot;: &quot;juez m or f (plural jueces, feminine jueza, feminine plural juezas)&quot;}], &quot;forms&quot;: [{&quot;form&quot;: &quot;jueces&quot;, &quot;tags&quot;: [&quot;plural&quot;]}, {&quot;form&quot;: &quot;jueza&quot;, &quot;tags&quot;: [&quot;feminine&quot;]}, {&quot;form&quot;: &quot;juezas&quot;, &quot;tags&quot;: [&quot;feminine&quot;, &quot;plural&quot;]}], &quot;wikipedia&quot;: [&quot;Diccionario cr\u00edtico etimol\u00f3gico castellano e hisp\u00e1nico&quot;], &quot;etymology_text&quot;: &quot;From Old Spanish juez, juiz, judez, from Latin i\u016bdex, j\u016bdex or i\u016bdicem, j\u016bdicem; possibly a semi-learned term.&quot;, &quot;etymology_templates&quot;: [{&quot;name&quot;: &quot;inh&quot;, &quot;args&quot;: {&quot;1&quot;: &quot;es&quot;, &quot;2&quot;: &quot;osp&quot;, &quot;3&quot;: &quot;juez&quot;}, &quot;expansion&quot;: &quot;Old Spanish juez&quot;}, {&quot;name&quot;: &quot;m&quot;, &quot;args&quot;: {&quot;1&quot;: &quot;osp&quot;, &quot;2&quot;: &quot;juiz&quot;}, &quot;expansion&quot;: &quot;juiz&quot;}, {&quot;name&quot;: &quot;m&quot;, &quot;args&quot;: {&quot;1&quot;: &quot;osp&quot;, &quot;2&quot;: &quot;judez&quot;}, &quot;expansion&quot;: &quot;judez&quot;}, {&quot;name&quot;: &quot;der&quot;, &quot;args&quot;: {&quot;1&quot;: &quot;es&quot;, &quot;2&quot;: &quot;la&quot;, &quot;3&quot;: &quot;iudex&quot;, &quot;4&quot;: &quot;i\u016bdex, j\u016bdex&quot;}, &quot;expansion&quot;: &quot;Latin i\u016bdex, j\u016bdex&quot;}, {&quot;name&quot;: &quot;m&quot;, &quot;args&quot;: {&quot;1&quot;: &quot;la&quot;, &quot;2&quot;: &quot;iudicem&quot;, &quot;3&quot;: &quot;i\u016bdicem, j\u016bdicem&quot;}, &quot;expansion&quot;: &quot;i\u016bdicem, j\u016bdicem&quot;}, {&quot;name&quot;: &quot;w&quot;, &quot;args&quot;: {&quot;1&quot;: &quot;Diccionario cr\u00edtico etimol\u00f3gico castellano e hisp\u00e1nico&quot;}, &quot;expansion&quot;: &quot;Diccionario cr\u00edtico etimol\u00f3gico castellano e hisp\u00e1nico&quot;}], &quot;sounds&quot;: [{&quot;ipa&quot;: &quot;/\u02c8xwe\u03b8/&quot;}, {&quot;ipa&quot;: &quot;[\u02c8xwe\u03b8]&quot;}, {&quot;ipa&quot;: &quot;/\u02c8xwes/&quot;}, {&quot;ipa&quot;: &quot;[\u02c8xwes]&quot;}, {&quot;audio&quot;: &quot;LL-Q1321 (spa)-AdrianAbdulBaha-juez.wav&quot;, &quot;text&quot;: &quot;Audio (Colombia)&quot;, &quot;tags&quot;: [&quot;Colombia&quot;], &quot;ogg_url&quot;: &quot;https://upload.wikimedia.org/wikipedia/commons/transcoded/6/63/LL-Q1321_%28spa%29-AdrianAbdulBaha-juez.wav/LL-Q1321_%28spa%29-AdrianAbdulBaha-juez.wav.ogg&quot;, &quot;mp3_url&quot;: &quot;https://upload.wikimedia.org/wikipedia/commons/transcoded/6/63/LL-Q1321_%28spa%29-AdrianAbdulBaha-juez.wav/LL-Q1321_%28spa%29-AdrianAbdulBaha-juez.wav.mp3&quot;}], &quot;word&quot;: &quot;juez&quot;, &quot;lang&quot;: &quot;Spanish&quot;, &quot;lang_code&quot;: &quot;es&quot;, &quot;senses&quot;: [{&quot;raw_glosses&quot;: [&quot;judge&quot;], &quot;tags&quot;: [&quot;feminine&quot;, &quot;masculine&quot;], &quot;glosses&quot;: [&quot;judge&quot;], &quot;id&quot;: &quot;juez-es-noun-EOhsZRTU&quot;}, {&quot;raw_glosses&quot;: [&quot;umpire; referee; official&quot;], &quot;tags&quot;: [&quot;feminine&quot;, &quot;masculine&quot;], &quot;glosses&quot;: [&quot;umpire; referee; official&quot;], &quot;id&quot;: &quot;juez-es-noun-J8f61gtZ&quot;, &quot;categories&quot;: [{&quot;name&quot;: &quot;Law&quot;, &quot;kind&quot;: &quot;topical&quot;, &quot;parents&quot;: [&quot;Society&quot;, &quot;All topics&quot;, &quot;Fundamental&quot;], &quot;source&quot;: &quot;w+disamb&quot;, &quot;orig&quot;: &quot;es:Law&quot;, &quot;langcode&quot;: &quot;es&quot;, &quot;_dis&quot;: &quot;8 92&quot;}, {&quot;name&quot;: &quot;Occupations&quot;, &quot;kind&quot;: &quot;topical&quot;, &quot;parents&quot;: [&quot;List of sets&quot;, &quot;People&quot;, &quot;All sets&quot;, &quot;Human&quot;, &quot;Fundamental&quot;, &quot;All topics&quot;], &quot;source&quot;: &quot;w+disamb&quot;, &quot;orig&quot;: &quot;es:Occupations&quot;, &quot;langcode&quot;: &quot;es&quot;, &quot;_dis&quot;: &quot;3 97&quot;}]}]}
</code></pre>
<pre class="language-julia"><code class="language-julia">julia<span class="token operator">></span> <span class="token keyword">function</span> get_words_regex<span class="token punctuation">(</span>file<span class="token punctuation">::</span>String<span class="token punctuation">)</span><br>           a<span class="token punctuation">::</span>Array<span class="token punctuation">{</span>Dict<span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><br>           <span class="token keyword">for</span> line <span class="token keyword">in</span> eachline<span class="token punctuation">(</span>file<span class="token punctuation">)</span><br>               ipa_sl <span class="token operator">=</span> collect<span class="token punctuation">(</span>eachmatch<span class="token punctuation">(</span><span class="token regex">r"(?&lt;=\"ipa\": \")\/.*?\/"</span><span class="token punctuation">,</span>line<span class="token punctuation">)</span><span class="token punctuation">)</span><br>               ipa_br <span class="token operator">=</span> collect<span class="token punctuation">(</span>eachmatch<span class="token punctuation">(</span><span class="token regex">r"(?&lt;=\"ipa\": \")\[.*?\]"</span><span class="token punctuation">,</span>line<span class="token punctuation">)</span><span class="token punctuation">)</span><br>               url <span class="token operator">=</span> collect<span class="token punctuation">(</span>eachmatch<span class="token punctuation">(</span><span class="token regex">r"(?&lt;=\"\w{3}_url\": \").*?(?=\")"</span><span class="token punctuation">,</span>line<span class="token punctuation">)</span><span class="token punctuation">)</span><br>               <span class="token keyword">if</span> length<span class="token punctuation">(</span>ipa_br<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">1</span> <span class="token operator">&amp;&amp;</span> length<span class="token punctuation">(</span>ipa_sl<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">1</span> <span class="token operator">&amp;&amp;</span> length<span class="token punctuation">(</span>url<span class="token punctuation">)</span> <span class="token operator">></span> <span class="token number">0</span><br>                   word <span class="token operator">=</span> match<span class="token punctuation">(</span><span class="token regex">r"(?&lt;=\"word\": \").*?(\?=\")"</span><span class="token punctuation">,</span>line<span class="token punctuation">)</span><br>                   push<span class="token operator">!</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span>Dict<span class="token punctuation">(</span><span class="token string">"word"</span><span class="token operator">=</span><span class="token operator">></span>word<span class="token punctuation">,</span><span class="token string">"phonemic"</span><span class="token operator">=</span><span class="token operator">></span>ipa_sl<span class="token punctuation">,</span><span class="token string">"phonetic"</span><span class="token operator">=</span><span class="token operator">></span>ipa_br<span class="token punctuation">)</span><span class="token punctuation">)</span><br>               <span class="token keyword">end</span><br>           <span class="token keyword">end</span><br>           <span class="token keyword">return</span> a<br>       <span class="token keyword">end</span></code></pre>
<p>Other things to improve:</p>
<ul>
<li>We probably want to narrow it down to items with <em>one</em> pronunciation, or we can't quite tell if we have the right pronunciation transcribed. (If we can find a way to differentiate e.g. between US and UK pronunciations and match each with the correct transcription, that'd be ðŸ’¯)</li>
<li>There are (generally) two transcriptions: a <a href="https://linguistics.stackexchange.com/questions/301/when-should-one-use-slashes-or-square-brackets-when-transcribing-in-ipa">phonemic and a phonetic</a>, the phonemic (in square brackets) being the more narrow one in general. It's maybe preferable to grab that one but then againâ€”why not both? It might be handy to have either option available, or to compare and see which is a more successful basis for a model.</li>
</ul>
<p>https://upload.wikimedia.org/wikipedia/commons/6/63/LL-Q1321_%28spa%29-AdrianAbdulBaha-juez.wav
https://upload.wikimedia.org/wikipedia/commons/6/63/LL-Q1321_%28spa%29-AdrianAbdulBaha-juez.wav
https://upload.wikimedia.org/wikipedia/commons/transcoded/6/63/LL-Q1321_%28spa%29-AdrianAbdulBaha-juez.wav</p>

  </main>
</body>
</html>